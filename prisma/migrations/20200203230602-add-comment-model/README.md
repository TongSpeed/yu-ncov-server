# Migration `20200203230602-add-comment-model`

This migration has been generated by fastspeeed at 2/3/2020, 11:06:02 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "quaint"."User" (
    "avatar" BOOLEAN NOT NULL DEFAULT false ,
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "email" TEXT NOT NULL DEFAULT '' ,
    "id" TEXT NOT NULL  ,
    "name" TEXT   ,
    "nickname" TEXT NOT NULL DEFAULT '' ,
    "password" TEXT NOT NULL DEFAULT '' ,
    "role" TEXT NOT NULL DEFAULT 'USER' ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "quaint"."Country" (
    "id" TEXT NOT NULL  ,
    "title" TEXT NOT NULL DEFAULT '' ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "quaint"."Province" (
    "country" TEXT NOT NULL  ,
    "id" TEXT NOT NULL  ,
    "title" TEXT NOT NULL DEFAULT '' ,
    PRIMARY KEY ("id"),FOREIGN KEY ("country") REFERENCES "Country"("id") ON DELETE RESTRICT
) 

CREATE TABLE "quaint"."City" (
    "id" TEXT NOT NULL  ,
    "province" TEXT NOT NULL  ,
    "title" TEXT NOT NULL DEFAULT '' ,
    PRIMARY KEY ("id"),FOREIGN KEY ("province") REFERENCES "Province"("id") ON DELETE RESTRICT
) 

CREATE TABLE "quaint"."Area" (
    "city" TEXT NOT NULL  ,
    "id" TEXT NOT NULL  ,
    "title" TEXT NOT NULL DEFAULT '' ,
    PRIMARY KEY ("id"),FOREIGN KEY ("city") REFERENCES "City"("id") ON DELETE RESTRICT
) 

CREATE TABLE "quaint"."VirusInfo" (
    "description" TEXT NOT NULL DEFAULT '' ,
    "id" TEXT NOT NULL  ,
    "title" TEXT NOT NULL DEFAULT '' ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "quaint"."VirusRecord" (
    "area" TEXT   ,
    "city" TEXT   ,
    "comment" TEXT   ,
    "confirmedCount" INTEGER   ,
    "country" TEXT NOT NULL  ,
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "createdBy" TEXT   ,
    "curedCount" INTEGER   ,
    "deadCount" INTEGER   ,
    "id" TEXT NOT NULL  ,
    "province" TEXT   ,
    "published" BOOLEAN NOT NULL DEFAULT false ,
    "publishedAt" DATE   ,
    "publishedBy" TEXT   ,
    "recordAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "sourceUrl" TEXT NOT NULL DEFAULT '' ,
    "suspectedCount" INTEGER   ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "updatedBy" TEXT   ,
    "virus" TEXT NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("createdBy") REFERENCES "User"("id") ON DELETE SET NULL,
FOREIGN KEY ("updatedBy") REFERENCES "User"("id") ON DELETE SET NULL,
FOREIGN KEY ("publishedBy") REFERENCES "User"("id") ON DELETE SET NULL,
FOREIGN KEY ("country") REFERENCES "Country"("id") ON DELETE RESTRICT,
FOREIGN KEY ("province") REFERENCES "Province"("id") ON DELETE SET NULL,
FOREIGN KEY ("city") REFERENCES "City"("id") ON DELETE SET NULL,
FOREIGN KEY ("area") REFERENCES "Area"("id") ON DELETE SET NULL,
FOREIGN KEY ("virus") REFERENCES "VirusInfo"("id") ON DELETE RESTRICT
) 

CREATE UNIQUE INDEX "quaint"."User.email" ON "User"("email")

CREATE UNIQUE INDEX "quaint"."User.name" ON "User"("name")

CREATE UNIQUE INDEX "quaint"."User.nickname" ON "User"("nickname")

CREATE UNIQUE INDEX "quaint"."Country.title" ON "Country"("title")

CREATE UNIQUE INDEX "quaint"."Province.title" ON "Province"("title")

CREATE UNIQUE INDEX "quaint"."VirusInfo.title" ON "VirusInfo"("title")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200203230602-add-comment-model
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,85 @@
+datasource db {
+  provider = "sqlite"
+  url      = "file:dev.db"
+  default  = true
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+enum Role {
+  USER
+  VERIFIED
+  ADMIN
+}
+
+model User {
+  id                  String        @default(cuid()) @id
+  email               String        @unique
+  name                String?       @unique
+  nickname            String        @unique
+  password            String
+  avatar              Boolean       @default(false)
+  role                Role          @default(USER)
+  virusRecords        VirusRecord[] @relation(name: "createdByUserWithVirusRecord")
+  updatedVirusRecords VirusRecord[] @relation(name: "updateByUserWithVirusRecord")
+  publicVirusRecords  VirusRecord[] @relation(name: "publishByUserWithVirusRecord")
+  createdAt           DateTime      @default(now())
+  updatedAt           DateTime      @updatedAt
+}
+
+model Country {
+  id       String     @default(cuid()) @id
+  title    String     @unique
+  provinces Province[]
+}
+
+model Province {
+  id      String  @default(cuid()) @id
+  title   String  @unique
+  country Country
+  cities  City[]
+}
+
+model City {
+  id       String   @default(cuid()) @id
+  title    String   
+  province Province
+  areas  Area[]
+}
+
+model Area {
+  id    String @default(cuid()) @id
+  title String 
+  city  City
+}
+
+model VirusInfo {
+  id          String @default(cuid()) @id
+  title       String @unique
+  description String
+}
+
+model VirusRecord {
+  id             String    @default(cuid()) @id
+  country        Country
+  virus          VirusInfo
+  province       Province?
+  city           City?
+  area           Area?
+  suspectedCount Int?
+  sourceUrl          String
+  confirmedCount Int?
+  curedCount     Int?
+  deadCount      Int?
+  comment        String?
+  published      Boolean   @default(false)
+  recordAt       DateTime  
+  createdAt      DateTime  @default(now())
+  updatedAt      DateTime  @updatedAt
+  publishedAt    DateTime?  
+  createdBy      User?     @relation(name: "createdByUserWithVirusRecord")
+  updatedBy      User?     @relation(name: "updateByUserWithVirusRecord")
+  publishedBy    User?     @relation(name: "publishByUserWithVirusRecord")
+}
```


